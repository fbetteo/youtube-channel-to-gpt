Video Title: How to Build a WhatsApp Agent with n8n (credential tutorial)
Video ID: A0OwvNOLNlw
URL: https://www.youtube.com/watch?v=A0OwvNOLNlw
View Count: 90,746

[00:00] Today I'm going to show you guys the
[00:01] quickest and easiest way to set up any
[00:03] end with WhatsApp so that when someone
[00:04] messages our business account, we can
[00:06] have an AI agent on the back end
[00:08] responding to them, booking in a
[00:09] meeting, whatever we want them to do. So
[00:11] right now you can see I have a WhatsApp
[00:12] trigger and if I click into this, you
[00:14] can see that we need to create a
[00:15] credential. So if I click on that, it
[00:17] prompts us for a client ID and a secret.
[00:19] So we have to head over to
[00:20] business.fas.com
[00:21] in order to set this up. So this is what
[00:23] the page should look like. I'm going to
[00:24] go ahead and log in with my Facebook
[00:25] account. And once you log in, it's going
[00:27] to look like this. if you've already set
[00:28] up like a business portfolio. If you
[00:30] haven't, on this lefth hand side, you're
[00:32] going to expand this open and then down
[00:33] here, create business portfolio. And
[00:35] yes, this is Hercules Detailing, which
[00:37] used to be my car detailing company.
[00:38] Anyways, you're going to go down here to
[00:39] the bottom left and click on settings.
[00:41] And then right here under accounts, you
[00:43] can see apps. So, you're going to click
[00:44] on that. And then you're going to add an
[00:45] app right here. And you're going to
[00:47] click on create a new app ID. Now, right
[00:49] here, it says your account must be
[00:50] confirmed before you can create new app.
[00:51] So, please confirm your account by
[00:53] adding a mobile number or credit card.
[00:54] So, if you haven't done that, you're
[00:55] going to go ahead and confirm your
[00:56] account real quick. All right. So, now
[00:58] that I went ahead and confirmed my
[00:59] account, I can actually create an app
[01:00] ID. So, I'm going to click on that. And
[01:02] what we're going to do is go ahead and
[01:03] create this app. All right. So, I just
[01:04] threw in Nitend test as my name. I'm
[01:06] going to hit next. Now, we have use
[01:07] cases. I'm just going to scroll to the
[01:08] bottom and hit other and continue on.
[01:10] Now, we have to select an app type, and
[01:12] it cannot be changed after you create
[01:13] the app. So, for this case, I'm going to
[01:15] go ahead and use business. So, we can
[01:16] use WhatsApp. And then, we're pretty
[01:18] much just confirming the details and
[01:19] selecting the right business portfolio
[01:21] for this to go under. And now, I'm going
[01:22] to click on create app. All right. All
[01:24] right. Now that we've got to this
[01:24] screen, what we want to do is set up the
[01:26] WhatsApp. So, I'm going to click on the
[01:27] setup button right here. And we're going
[01:29] to go over to the lefth hand side under
[01:30] app settings and click on basic. And
[01:33] now, here's the screen that we were
[01:34] looking for where we can right here get
[01:35] our app ID and our secret. So, I'm first
[01:37] of all just going to copy this app ID.
[01:39] We're going to paste that right into
[01:40] here as the client ID. And then I'm
[01:42] going to go back into this screen, copy
[01:43] the app secret, and paste it into Nitin.
[01:46] There we go. Everything's been set up.
[01:47] I'm going to hit save. And we should get
[01:48] a green message right here that says
[01:50] connection tested successfully. Okay.
[01:52] Okay, so now we have the trigger set up,
[01:54] but we need to make sure we set up like
[01:55] a number that it's going to text from
[01:57] and that we can respond back to it. And
[01:59] unfortunately, it's not super simple
[02:00] because there's like two different types
[02:02] of credentials. One for the trigger and
[02:03] one for the node that's going to send a
[02:05] message back to that same number. So,
[02:07] let's set that up real quick. So, I'm
[02:09] going to click on the plus right after
[02:10] the WhatsApp trigger. And I am just
[02:12] going to add an AI agent just so I can
[02:14] show you guys how it'll look when you
[02:16] have an agent getting your messages and
[02:18] responding to you in WhatsApp. And now,
[02:19] we just need to connect an AI chat model
[02:21] to give the agent a brain. So, I'm just
[02:22] going to hook up Open Router real quick.
[02:24] And then what we want to do is add
[02:25] another node after this agent to send a
[02:27] message back to WhatsApp. So, we'll
[02:29] click on WhatsApp BusinessCloud and we
[02:30] will choose send message.
[02:33] And now, here's the issue. You can see
[02:35] we don't have a credential set up
[02:36] because this is a different type of
[02:37] WhatsApp node. So, we're going to have
[02:39] to create a new credential, but this is
[02:41] different than a ID and a secret. This
[02:43] is an access token and a business
[02:44] account ID. So, let's head back over to
[02:46] our Meta Suite and set this up. All
[02:49] right. So, we're going to switch back
[02:50] over here. And what we need to do now is
[02:52] on this lefth hand side under WhatsApp,
[02:54] we're going to click on API setup. So
[02:56] this is what your screen should look
[02:57] like right here. You can see we have a
[02:58] test number, which is one that Facebook
[03:00] is just going to provide. You can go
[03:01] ahead and connect like a business phone
[03:02] number if you want, but right now we're
[03:04] just going to stick with that test
[03:05] number. And then we also need to input a
[03:07] recipient phone number. So I'm going to
[03:08] throw that in there real quick. Now that
[03:10] we've set that up, we can go ahead up
[03:11] here and click generate access token. So
[03:13] I'm going to click on this button. It's
[03:14] going to ask us if we're good to
[03:15] continue on this Facebook account. So
[03:17] NAND test will receive your name and
[03:19] profile picture. I'm going to continue.
[03:20] You can opt in for just this WhatsApp
[03:22] account or you can just opt into all
[03:24] current and future. So, I'm going to do
[03:25] that. And then we're basically just
[03:26] reviewing what this app can do. So,
[03:28] manage your WhatsApp accounts and manage
[03:30] and access conversations in WhatsApp.
[03:32] So, if you're good with that, you'll hit
[03:33] save. And now that we're connected, what
[03:35] we have is our access token right up
[03:37] here and our business account right
[03:39] here. So, I'm going to copy the access
[03:40] token. And I just pasted that in right
[03:42] here. Switch back over. We're going to
[03:43] grab our WhatsApp business account ID
[03:46] and then we're going to paste that in
[03:47] right here. All right. There we go.
[03:48] We're going to hit save and hopefully we
[03:50] get green once again. Connection tested
[03:51] successfully. And now we can go ahead
[03:53] and test out the whole flow. So I'm
[03:56] going to connect the sender phone number
[03:57] which is the test one that Facebook gave
[03:59] us. I'm going to add in my WhatsApp
[04:01] number with the country code and
[04:02] everything so we can test out if it
[04:03] works. And then for the text body I'm
[04:06] just going to put test to make sure that
[04:07] this actually goes through. All right.
[04:08] So let's close out of here and hit save.
[04:10] And so right now just because our
[04:11] workflow is inactive, we're going to
[04:13] have to hit execute workflow every time
[04:15] to make sure that our WhatsApp trigger
[04:16] is listening. Once your app is in
[04:17] production, you won't have to do this.
[04:19] All right. So, what I did over here is
[04:20] my WhatsApp and this is the test number.
[04:22] So, I'm going to hit execute workflow.
[04:24] This trigger is now listening for us.
[04:25] So, I'm just going to right here say hi.
[04:28] And we'll see if our edit in workflow
[04:30] grabs it, which it did. But now, we just
[04:32] have to actually configure this agent
[04:34] real quick to accept the message. So,
[04:36] I'm going to click into the agent. For
[04:37] the user message, I'm going to choose
[04:39] define below. And all I have to do is
[04:41] drag in the actual field that has the
[04:43] variable, which is our text message. So
[04:45] that would be right here at the bottom.
[04:46] You can see the message I sent was hi.
[04:48] So we're going to grab that body field.
[04:50] And now the agent's going to see
[04:51] whatever we send to it in WhatsApp.
[04:53] Okay. So that's set up. I'm just going
[04:55] to hit save. We're going to hit execute
[04:56] workflow once again. And now it should
[04:58] be listening to us. I don't know why
[04:59] visually it's doing that. Just a little
[05:01] bug. But I'm going to say hello. The
[05:03] WhatsApp trigger is going to get that
[05:05] message. The agent's going to think
[05:06] about it and respond to us. And we get
[05:08] the message that we set up, which was
[05:10] test.
[05:12] So from here, you're basically done. All
[05:14] you want to do is configure the agent's
[05:15] response to be the thing that's sent
[05:17] back to us in WhatsApp. So the way we do
[05:19] that is we click into this node right
[05:21] here. Instead of sending over test,
[05:23] we're going to send over the variable,
[05:24] which is whatever the agent responds to
[05:26] us with. So I'm just going to grab the
[05:27] output, put that right here. And now
[05:29] when we do our final test, this should
[05:31] work and we can have a conversation with
[05:32] this AI agent. So once again, I'm going
[05:34] to hit execute workflow. I'm going to
[05:36] come into WhatsApp and just say, tell me
[05:38] a joke. And it's going to get that
[05:41] message. The agent's going to actually
[05:42] write us a joke. and we get it back to
[05:44] us in WhatsApp. It says, "Sure, here's
[05:46] one for you. Why don't scientists trust
[05:48] Adams?" Because they make up everything.
[05:49] And from here, you can obviously like
[05:51] connect memory. You can connect some
[05:52] tools. You can connect your different
[05:53] CRM or whatever you need to do. And now
[05:56] people can access this phone number.
[05:58] Once again, you can switch out for your
[05:59] business phone number. And you should be
[06:01] able to have this WhatsApp NAND
[06:03] automation built and running for you.
[06:05] And another thing just to keep in mind
[06:06] as well is that if people are able to
[06:08] just constantly text this number right
[06:10] here, if you're using an open router or
[06:12] like an open AAI or Enthropic or any
[06:14] closed source AI model where you pay for
[06:16] credits, it will be eating up your
[06:18] credits every time someone messages it.
[06:20] So someone spams it with like a million
[06:21] messages, that cost will fall on you. So
[06:24] just wanted to throw that out there real
[06:25] quick. But hopefully now you are set up
[06:26] with WhatsApp and you are good to go and
[06:28] start building some automations. And if
[06:30] you're looking for some support when
[06:31] you're setting up this type of
[06:32] automation on the back end with NAND,
[06:34] definitely check out my paid community.
[06:35] The link for that will be down in the
[06:36] description. And it's a really cool
[06:38] space of almost 2,000 members who are
[06:40] always building every day with NADN.
[06:42] Besides the community aspect, we have a
[06:44] classroom with two full courses, agent
[06:46] zero, which is the foundations of AI
[06:47] automation, and then 10 hours to 10
[06:49] seconds where you learn how to identify,
[06:51] design, and build time-saving
[06:53] automations. I'd love to see you guys in
[06:54] this community. But that's going to do
[06:56] it for the video. If you learned
[06:57] something new or this was helpful,
[06:58] please give it a like. It helps me out a
[07:00] ton. And I'll see you guys in the next
[07:01] one.